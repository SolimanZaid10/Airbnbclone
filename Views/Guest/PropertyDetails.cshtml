@model PropertyDetailsViewModel
@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    ViewData["Title"] = "Details";
}

@section Styles {
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <!--calender css-->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.9/css/all.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <link rel="stylesheet" href="~/css/propDetails.css" />
    <link rel="stylesheet" href="~/css/Buttons.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
}

<!--start pic-caursel-->
<section class="pic-caursel">
    <div id="carouselExampleControls" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="~/@Model.Property.Photos[0].Url" class="d-block w-100" alt="image-0">
            </div>
            @for (var i = 1; i < Model.Property.Photos.Count; i++)
            {
                <div class="carousel-item">
                    <img src="~/@Model.Property.Photos[i].Url" class="d-block w-100" alt="prop-image-@i">
                </div>
            }
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls"
                data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls"
                data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>
</section>
<!--end pic-caursel-->
<!--start title section-->
<section class="container mt-5" style="position: relative;">
    <div>
        <h1>
            @Model.Property.Title
        </h1>
    </div>
    <div class="information">
        <div>
            <span>
                <i class="fas fa-star red_icon"></i>
                <a href="#"> <span class="dark-span">5.0</span> </a>
                <span class="light-span">(23)</span>
            </span>
            <span>&middot;</span>
            <span class="address">
                <a asp-controller="search" asp-action="index" asp-route-cityid="@Model.Property.City.Id"><span class="light-anchor">@Model.Property.City.Name, @Model.Property.City.State.Name, @Model.Property.City.State.Country.Name</span></a>
            </span>
        </div>
    </div>
    <button class="btn-big-like" type="button">
        <svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"
             role="presentation" focusable="false"
             style="display: block; fill: transparent; height: 24px; width: 24px; stroke: rgb(34, 34, 34); stroke-width: 2; overflow: visible;">
            <path d="m16 28c7-4.733 14-10 14-17 0-1.792-.683-3.583-2.05-4.95-1.367-1.366-3.158-2.05-4.95-2.05-1.791 0-3.583.684-4.949 2.05l-2.051 2.051-2.05-2.051c-1.367-1.366-3.158-2.05-4.95-2.05-1.791 0-3.583.684-4.949 2.05-1.367 1.367-2.051 3.158-2.051 4.95 0 7 7 12.267 14 17z">
            </path>
        </svg>
        <!-- <svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="presentation"
            focusable="false"
            style="display: block; fill: rgb(255, 56, 92); height: 24px; width: 24px; stroke: rgb(255, 56, 92); stroke-width: 2; overflow: visible;">
            <path
                d="m16 28c7-4.733 14-10 14-17 0-1.792-.683-3.583-2.05-4.95-1.367-1.366-3.158-2.05-4.95-2.05-1.791 0-3.583.684-4.949 2.05l-2.051 2.051-2.05-2.051c-1.367-1.366-3.158-2.05-4.95-2.05-1.791 0-3.583.684-4.949 2.05-1.367 1.367-2.051 3.158-2.051 4.95 0 7 7 12.267 14 17z">
            </path>
        </svg> -->
    </button>
</section>
<!--end title section-->
<!--start pic section-->
<section class="pic-area">
    <div class="container">
        <div class="pic_content">
            <img class="img1" src="~/@Model.Property.Photos[0].Url">

            @for (int i = 1; i < 5; i++)
            {
                <img class="img@(i + 1)" src="~/@Model.Property.Photos[i].Url">
            }
        </div>
        <div class="morebtn-containter">
            <span>
                <i class="fas fa-angle-double-right"></i>
            </span>
            <!--start offcanvas-->
            <button data-bs-toggle="offcanvas" data-bs-target="#offcanvasBottom" aria-controls="offcanvasBottom">
                Show
                all photos
            </button>
            <div class="offcanvas offcanvas-bottom" tabindex="-1" id="offcanvasBottom"
                 aria-labelledby="offcanvasBottomLabel">
                <div class="offcanvas-header">

                    <button type="button" class=" text-reset dark_icon" data-bs-dismiss="offcanvas" aria-label="Close">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                </div>
                <div style="height: 100%;" class="offcanvas-body">
                    <div class="container">
                        @foreach (var image in Model.Property.Photos)
                        {
                            <img src="~/@image.Url" />
                        }
                    </div>
                </div>
            </div>
            <!--end offcanvas-->
        </div>
    </div>
</section>
<!--end pic section-->
<!--start details section-->
<section class="details">
    <div class="container">
        <div class="data">
            <!--grid-->
            <div class="houseData">
                <!--basic info-->
                <div class="data-plugin-in-point">
                    <h1>@Model.Property.GuestPlaceType.Name hosted by Ahmed</h1>
                    <span>@Model.Property.Capacity guests</span>
                    <span>&middot;</span>
                    <span>@Model.Property.NumberOfBedRooms bedroom</span>
                    <span>&middot;</span>
                    <span>@Model.Property.NumberOfBeds beds</span>
                    <span>&middot;</span>
                    <span>@Model.Property.NumberOfBathrooms baths</span>
                    <div class="hostImg">
                        <!-- Host Image Tag Here -->
                    </div>
                </div>
                <hr>
                <!----- host description ------>
                <div class="data-plugin-in-point">
                    <h1 class="mb-4">Description</h1>
                    <p class="readmore">
                        @Model.Property.Description
                    </p>
                </div>
                <hr>
                <!----- amenities list ------>
                <div class="data-plugin-in-point">
                    <h1 class="mb-4">Amenities</h1>
                    <div id="divAmenity" style="overflow:hidden;height:140px;">
                        <!--grid-->
                        <div class="row">

                            @foreach (var item in Model.Property.Amenities)
                            {

                                <div class="Amenity col-12 col-lg-6">
                                    @Html.Raw(@item.Amenity.Icon)
                                    <span class="dark-light">@item.Amenity.Name</span>
                                </div>
                            }
                        </div>
                    </div>
                    @if (Model.Property.Amenities.Count > 6)
                    {
                        <button id="show_all_Amenity" class="show-more">Show More</button>
                        <button id="show_less_Amenity" class="show-more hide">Show Less</button>
                    }
                </div>

                <div class="data-plugin-in-point">
                    <hr />
                    <h1 class="mb-4 mt-2">House Rules</h1>
                    <div id="house-rules">
                        <!--grid-->
                        <div class="row">

                            @foreach (var item in Model.Property.HouseRules)
                            {
                                <div class="Amenity col-12 col-lg-6">
                                    <i class="fas fa-exclamation"></i>
                                    <span class="dark-light">@item.HouseRule.Name</span>
                                </div>
                            }
                        </div>
                    </div>
                </div>

                <div class="data-plugin-in-point">
                    <hr />
                    <h1 class="mb-4 mt-2">Things to know</h1>
                    <div id="for-guests">
                        <!--grid-->
                        <div class="row">

                            @foreach (var item in Model.Property.GuestDetails)
                            {
                                <div class="Amenity col-12 col-lg-6">
                                    <i class="fas fa-exclamation"></i>
                                    <span class="dark-light">@item.GuestDetail.Name</span>
                                </div>
                            }
                        </div>
                    </div>
                </div>
            </div>
            <!--start check-card-->
        </div>

        <div class="card check">
            <div class="check-container">
                <div class="check-title">

                    <span class="dark-span" id="amountspan">
                        <h1 style="display: inline;" id="total-price">&#36 35</h1>
                        <span>/night</span>
                    </span>
                    <span class="rightt">
                        <i class="fas fa-star red_icon"></i>
                        <a href="#"> <span class="dark-span">5.0</span> </a>
                        <span class="light-span">(23)</span>
                    </span>
                </div>
                <div class="check-body">
                    <!--grid-->
                    <table class="card-table" cellspacing="10">
                        <thead>
                            <tr>
                                <td colspan="2">
                                    <div class="check-in ">
                                        <div class="font-light-dark">CHECK-IN <pre style="display: inline;">            </pre> CHECK-OUT</div>
                                        <div>
                                            <input class="font-light-dark" style="display: inline-block; width: 45%; margin-right: auto;" id="check-in" />
                                            <input class="font-light-dark" style="display: inline-block; width: 45%;" id="check-out" />
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </thead>
                        <tr>
                            <td colspan="2">
                                <div class="guest-no">
                                    <div class="Adult">
                                        <span class="dark-span">Guests</span>
                                    </div>
                                    <div class="spacer"></div>
                                    <div class="add-sub">
                                        <div>
                                            <span class="sub">
                                                <button class="sub-btn"
                                                        id="sub-btn-Adult">
                                                    <span>-</span>
                                                </button>
                                            </span>
                                            <span class="value" id="Adult-value">1 </span>
                                            <span class="add">
                                                <button class="add-btn"
                                                        id="add-btn-Adult">
                                                    <span>+</span>
                                                </button>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <div class="text-center text-danger" id="check-error" style="display: none; margin: auto; width: 100%;">Not Available!</div>
                                <button class="btn-glow" id="check-btn" onclick="checkAvailability()">
                                    <span class="glow">
                                        Check availability
                                    </span>
                                    Check availability
                                </button>
                                <a class="btn-glow text-white" style="display: none;" id="reserve-btn">
                                    <span class="glow">
                                        Reserve
                                    </span>
                                    Reserve
                                </a>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <!--end check-card-->
        </div>
    </div>

    @*Reviews*@
    <div class="Reviews">
        <hr>

        <h1 class="mt-5">Reviews</h1>

        <div class="total-review">
            <i class="fas fa-star red_icon"></i>
            <span class="dark-span">5.0 (30 Reviews)</span>
        </div>

        <div class="row mt-5 ">
            <div class="review col-12 col-lg-6">
                <div class="review-header">
                    <div class="review-image">
                        <img src="https://banner2.cleanpng.com/20180920/yko/kisspng-computer-icons-portable-network-graphics-avatar-ic-5ba3c66df14d32.3051789815374598219884.jpg" alt="imag" />
                    </div>
                    <div class="review-user">
                        <h5>Ahmed</h5>
                        <div>@DateTime.Now.ToLongDateString()</div>
                    </div>
                    <div class="spacer"></div>
                    <div>
                        <i class="fas fa-star red_icon"></i>
                        <span class="dark-span">5.0</span>
                    </div>
                </div>
                <div class="review-body">
                    Review Body will be written here..........................................
                    Review Body will be written here..........................................
                    Review Body will be written here..........................................
                    Review Body will be written here..........................................
                    Review Body will be written here..........................................
                </div>
            </div>
            <div class="review col-12 col-lg-6">
                <div class="review-header">
                    <div class="review-image">
                        <img src="https://banner2.cleanpng.com/20180920/yko/kisspng-computer-icons-portable-network-graphics-avatar-ic-5ba3c66df14d32.3051789815374598219884.jpg" alt="imag" />
                    </div>
                    <div class="review-user">
                        <h5>Ahmed</h5>
                        <div>@DateTime.Now.ToLongDateString()</div>
                    </div>
                    <div class="spacer"></div>
                    <div>
                        <i class="fas fa-star red_icon"></i>
                        <span class="dark-span">5.0</span>
                    </div>
                </div>
                <div class="review-body">
                    Review Body will be written here..........................................
                    Review Body will be written here..........................................
                    Review Body will be written here..........................................
                    Review Body will be written here..........................................
                    Review Body will be written here..........................................
                </div>
            </div>
            <div class="review col-12 col-lg-6">
                <div class="review-header">
                    <div class="review-image">
                        <img src="https://banner2.cleanpng.com/20180920/yko/kisspng-computer-icons-portable-network-graphics-avatar-ic-5ba3c66df14d32.3051789815374598219884.jpg" alt="imag" />
                    </div>
                    <div class="review-user">
                        <h5>Ahmed</h5>
                        <div>@DateTime.Now.ToLongDateString()</div>
                    </div>
                    <div class="spacer"></div>
                    <div>
                        <i class="fas fa-star red_icon"></i>
                        <span class="dark-span">5.0</span>
                    </div>
                </div>
                <div class="review-body">
                    Review Body will be written here..........................................
                    Review Body will be written here..........................................
                    Review Body will be written here..........................................
                    Review Body will be written here..........................................
                    Review Body will be written here..........................................
                </div>
            </div>
        </div>
    </div>

    <div class="Reviews">
        <hr />
        <h1 class="mt-4">Location</h1>
        <div>
            @Model.Property.Street,
            @Model.Property.City.Name,
            @Model.Property.City.State.Name,
            @Model.Property.City.State.Country.Name
        </div>
        <div id="map"></div>
    </div>
</section>
<!--end details section-->

@section Scripts {

    <script src="https://cdn.jsdelivr.net/npm/@@popperjs/core@2.9.1/dist/umd/popper.min.js"
            integrity="sha384-SR1sx49pcuLnqZUnnPwx6FCym0wLsk5JZuNx2bPPENzswTNFaQU1RDvt3wT4gWFG"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.min.js"
            integrity="sha384-j0CNLUeiqtyaRmlzUHCPZ+Gy5fQu0dQ6eZ/xAww941Ai1SxSY+0EQqNXNE6DZiVc"
            crossorigin="anonymous"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB_BPkgYNWQNTrzfp-1tNW1A1tekxyNj1w&callback=initMap&libraries=&v=weekly"
            async></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/jquery/latest/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
    <!--logic.js-->
    <script src="~/js/glow.js" type="text/javascript"></script>
    <script>
        var unavailableDays = [@foreach (var item in Model.Property.UnavailableDays)
            {
                @:'@item.UnavailableDay.ToShortDateString()',
            }]

        $('#check-in').daterangepicker({
            opens: 'left',
            autoUpdateInput: false,
            isInvalidDate: (date) => {
                    $('.cancelBtn').text('Clear');
                return unavailableDays.indexOf(date._d.toLocaleDateString()) != -1
                    || new Date() >= date._d;
                },
            },
            function (start, end, label) {
            console.log("A new date selection was made: " + start.format('YYYY-MM-DD') + ' to ' + end.format('YYYY-MM-DD'));
        });

        $('#check-in').on('apply.daterangepicker', function (ev, picker) {
            $('#check-in').val(picker.startDate.format('YYYY-MM-DD'));
            $('#check-out').val(picker.endDate.format('YYYY-MM-DD'));
        });

        $('#check-in').on('cancel.daterangepicker', function (ev, picker) {
            $('#check-in, #check-out').val('');
        });

        $('#check-out').on('focus', () => {
            $('#check-in').focus();
        });

        $('#check-in').focus(() => {
            $('#check-btn').css({ display: 'flex', });
            $('#reserve-btn').css({ display: 'none', });
            $('#check-error').css({ display: 'none', });
        });

        $('#show_all_Amenity').click(function () {
            $('#divAmenity').css("height", "fit-content");
            $('#show_all_Amenity').addClass('hide');
            $('#show_less_Amenity').removeClass('hide');
        });

        $('#show_less_Amenity').click(function () {
            $('#divAmenity').css("height", "140px");
            $('#show_all_Amenity').removeClass('hide');
            $('#show_less_Amenity').addClass('hide');
        });

        $('#add-btn-Adult').click(function (event) {
            var AdultValue = $('#Adult-value').html();
            if (AdultValue < @(Model.Property.Capacity)) {
                AdultValue++;
                $('#Adult-value').html(AdultValue);
            }
            event.stopPropagation();
        });

        $('#sub-btn-Adult').click(function (event) {
            var AdultValue = $('#Adult-value').html();
            if (AdultValue > 1) {
                AdultValue--;
                $('#Adult-value').html(AdultValue);
            }
            event.stopPropagation();
        });

        function initMap() {
            map = new google.maps.Map(document.getElementById("map"), {
                zoom: 15,
                disableDefaultUI: false,
            });

            let initialLocation = new google.maps.LatLng(@(Model.Property.Coordinates.Coordinate.Y), @(Model.Property.Coordinates.Coordinate.X));
            map.setCenter(initialLocation);

            const marker = new google.maps.Marker({
                position: initialLocation,
                map: map,
                icon: '../../images/home.png',
            });

        }
        function checkAvailability() {
            var checkIn = $('#check-in').val();
            var checkOut = $('#check-out').val();

            $.ajax({
                type: "GET",
                url: `/Property/CheckDate/@Model.Property.Id?checkIn=${checkIn}&checkOut=${checkOut}`,
                success: function (response) {
                    $('#reserve-btn').css({ display: 'flex', });
                    $('#check-btn').css({ display: 'none', });
                },
                error: function (error) {
                    $('#check-error').css({ display: 'flex', });
                }
            });
        }
    </script>
}